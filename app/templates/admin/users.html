{% extends "admin/layout.html" %}
{% block title %}Kullanıcı Listesi{% endblock title%}

{% block content %}
<section class="py-5">
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header d-flex justify-content-between align-items-center">
          <h3 class="h6 text-uppercase mb-0">Kayıtlı Kullanıcılar</h3>
          <a href="{{ url_for('admin.add_user') }}" class="btn btn-success">+ Kullanıcı Ekle</a>
        </div>
      
        <div class="card-body">
          {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                            <div class="alert alert-{{ category }}">{{ message }}</div>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
          <table class="table table-striped" id="kullaniciTablosu">
            <thead>
              <tr>
                <th>ID</th>
                <th>Kullanıcı Adı</th>
                <th>Email</th>
                <th>Aksiyonlar</th>
              </tr>
            </thead>
            <tbody>
              {% for user in users %}
              <tr>
                <td>{{ user.id }}</td>
                <td>{{ user.first_name }} {{ user.last_name }}</td>
                <td>{{ user.email }}</td>
                <td>
                  <a href="" class="btn btn-primary btn-sm">Detay</a>
                  <button data-user-id="{{ user.user_id }}" class="btn btn-danger btn-sm" onclick="showUserDeletionConfirmation(this)">Sil</button>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Silme Onay Modalı -->
<div id="userDeletionConfirmModal" class="modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Kullanıcı Silme Onayı</h5>
      </div>
      <div class="modal-body">
        <p>Kullanıcıyı silmek istediğinizden emin misiniz?</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" onclick="deleteUser()">Evet, Sil</button>
        <button type="button" class="btn btn-secondary" onclick="cancelUserDeletion()">İptal</button>
      </div>
    </div>
  </div>
</div>

{% endblock content %}
