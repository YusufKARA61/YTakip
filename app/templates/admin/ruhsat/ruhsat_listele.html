{% extends "admin/layout.html" %}
{% block title %}Ruhsat Bilgileri Listesi{% endblock %}

{% block content %}
<section class="py-5">
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
                <h6 class="text-uppercase mb-0">Ruhsat Bilgileri</h6>
                <a href="{{ url_for('ruhsat.ruhsat_ekle') }}" class="btn btn-primary">+ Ruhsat Ekle</a>
            </div>
        </div>
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} fade show" role="alert">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <div class="card-body">
          <table class="table table-striped">
            <thead>
              <tr>
                <th>Yapı Adı</th>
                <th>Ruhsat Tarihi</th>
                <th>Zabıt Tarihi</th>
                <th>İmar Barışı</th>
                <th>Mahalle</th>
                <th>Ada</th>
                <th>Parsel</th>
                <th>Parsel Türü</th>
                <th>Mevcut İnşaat Alanı</th>
                <th>Tapu Alanı</th>
                <th>Blok Sayısı</th>
                <th>Konut BB Sayısı</th>
                <th>Ticari BB Sayısı</th>
                <th>Toplam BB Sayısı</th>
                <th>Toplam İnşaat Alanı</th>
                <th>İşlemler</th>
              </tr>
            </thead>
            <tbody>
              {% for ruhsat in ruhsatlar %}
              <tr>
                <td>{{ ruhsat.yapi_adi }}</td>
                <td>{{ ruhsat.ruhsat_tarihi }}</td>
                <td>{{ ruhsat.zabit_tarih }}</td>
                <td>{{ 'Evet' if ruhsat.imar_barisi else 'Hayır' }}</td>
                <td>{{ ruhsat.mahalle }}</td>
                <td>{{ ruhsat.ada }}</td>
                <td>{{ ruhsat.parsel }}</td>
                <td>{{ ruhsat.parsel_turu }}</td>
                <td>{{ ruhsat.mevcut_insaat_alan }}</td>
                <td>{{ ruhsat.tapu_alani }}</td>
                <td>{{ ruhsat.blok_sayi }}</td>
                <td>{{ ruhsat.konut_bb_sayi }}</td>
                <td>{{ ruhsat.ticari_bb_sayi }}</td>
                <td>{{ ruhsat.toplam_bb_sayi }}</td>
                <td>{{ ruhsat.toplam_insaat_alan }}</td>
                <td>
                  <a href="{{ url_for('ruhsat.ruhsat_duzenle', id=ruhsat.id) }}" class="btn btn-primary btn-sm">Düzenle</a>
                  <form action="{{ url_for('ruhsat.ruhsat_sil', id=ruhsat.id) }}" method="post" style="display: inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Bu kaydı silmek istediğinizden emin misiniz?');">Sil</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>
<script>
  // Mesajları belirlenen süre sonra kaybolacak şekilde ayarla
  window.onload = function() {
      // Tüm alert div'lerini seç
      var alerts = document.querySelectorAll('.alert');
      // Her bir alert için kaybolma işlemi
      alerts.forEach(function(alert) {
          // 3000ms (3 saniye) sonra kaybol
          setTimeout(function() {
              alert.style.display = 'none'; // alert'i gizle
          }, 3000); // 3000 milisaniye = 3 saniye
      });
  };
</script>
{% endblock %}
