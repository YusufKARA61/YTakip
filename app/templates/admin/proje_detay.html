{% extends "admin/layout.html" %}

{% block title %} Proje Detayları {% endblock title %}

{% block content %}
<section class="py-5">
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <ul class="nav nav-tabs" id="myTabs" role="tablist">
            <li class="nav-item">
              <a class="nav-link active" id="ada-parsel-tab" data-toggle="tab" href="#ada-parsel" role="tab" aria-controls="ada-parsel" aria-selected="true">Ada/Parsel Onay Durumu</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="fizibilite-tab" data-toggle="tab" href="#fizibilite" role="tab" aria-controls="fizibilite" aria-selected="false">Fizibilite</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="daire-tipleri-tab" data-toggle="tab" href="#daire-tipleri" role="tab" aria-controls="daire-tipleri" aria-selected="false">Seçilen Daire Tipleri</a>
            </li>
          </ul>
        </div>
        <div class="card-body">
          <div class="tab-content" id="myTabContent">
            <!-- Ada/Parsel Onay Durumu Tab -->
            <div class="tab-pane fade show active" id="ada-parsel" role="tabpanel" aria-labelledby="ada-parsel-tab">
              <div class="row">
                {% for veri in veriler %}
                <div class="col-md-3">
                  <canvas id="kdsidOranGrafik{{ loop.index }}" width="200" height="200"></canvas>
                  <ul>
                    <li>Ada: {{ veri.ada }}, Parsel: {{ veri.parsel }}</li>
                    <li>Toplam Brüt Alan: {{ veri.kdsid_toplam }} m²</li>
                    <li>Onaylanan Brüt Alan: {{ veri.kdsid_onayli_toplam }} m²</li>
                  </ul>
                </div>
                {% endfor %}
              </div>
            </div>

            <!-- Fizibilite Tab -->
            <div class="tab-pane fade" id="fizibilite" role="tabpanel" aria-labelledby="fizibilite-tab">
              <div class="text-right">
                <form method="post" action="/export_excel">
                  <input type="hidden" name="proje_id" value="{{ proje.proje_id }}">
                  <button type="submit" class="btn btn-primary">Excel'e Aktar</button>
                </form>
              </div>
              <br>
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>Ada</th>
                    <th>Parsel</th>
                    <th>TcNo</th>
                    <th>İsim</th>
                    <th>Arsa Alanı</th>
                    <th>Kişi Arsa Alanı</th>
                    <th>İmar Durumu</th>
                    <th>Kişi İmar Durumu</th>
                    <th>Kişi Artışlı Miktar</th>
                    <th>Onay Durumu</th>
                  </tr>
                </thead>
                <tbody>
                  {% for veri in fizveriler %}
                  <tr>
                    <td>{{ veri.ada }}</td>
                    <td>{{ veri.parsel }}</td>
                    <td>{{ veri.tcno }}</td>
                    <td>{{ veri.isim }}</td>
                    <td>{{ veri.arsaalan }} m²</td>
                    <td>{{ veri.kisiarsaalan | float | round(2) }} m²</td>
                    <td>{{ veri.mvid | float | round(2) }} m²</td>
                    <td>{{ veri.mvid_hisseoran | float | round(2)}}</td>
                    <td>{{ veri.kdsid_hisseoran | float | round(2) }} m²</td>
                    <td>
                      <input type="checkbox" name="onay_durumu_checkbox" value="{{ veri.veri_id }}" {% if veri.onay_durumu %}checked{% endif %}>
                  </td>
                  
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>

            <!-- Seçilen Daire Tipleri Tab -->
            <!-- Burada daire tipleriyle ilgili içerik yer alacak -->
            <div class="tab-pane fade" id="daire-tipleri" role="tabpanel" aria-labelledby="daire-tipleri-tab">
              <!-- Seçilen Daire Tipleri İçeriği -->
            </div>
          </div>
        </div>
        <div class="text-right">
          <a href="{{ url_for('proje.projeler') }}" class="btn btn-primary">Geri Dön</a>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock content %}
